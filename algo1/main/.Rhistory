source("~Documents/Rstuff/hw 8/algo 1/headers/def_cdf_inv.R")
source("~/Documents/Rstuff/hw 8/algo 1/headers/def_cdf_inv.R")
inverse_sampling = function(n,cdf,cdf_inv,...){
if(missing(cdf_inv)){
writeLines("cdf_inv not supplied, numerical root finding utilized, this is inefficient\n")
cdf_inv = def_cdf_inv(cdf,...)
}
V_cdf_inv = Vectorize(cdf_inv, vectorize.args = names(formals(cdf_inv))[1])
return(V_cdf_inv(runif(n),...))
}
inverse_sampling(100,pnorm,mean=100,sd=25)
inverse_sampling(100,pnorm,qnorm,mean=100,sd=25)
library(testthat)
def_cdf_inv( pnorm, mean=100, sd=25)
def_cdf_inv(pnorm, mean=100, sd=25, p=0.1)
source("~/Documents/Rstuff/hw 8/algo 1/headers/def_cdf_inv.R")
inverse_sampling = function(n,cdf,cdf_inv,...){
if(missing(cdf_inv)){
writeLines("cdf_inv not supplied, numerical root finding utilized, this is inefficient\n")
cdf_inv = def_cdf_inv(cdf,...)
}
V_cdf_inv = Vectorize(cdf_inv, vectorize.args = names(formals(cdf_inv))[1])
return(V_cdf_inv(runif(n),...))
}
def_cdf_inv(pnorm, mean=100, sd=25, p=0.1)
def_cdf_inv(pnorm, mean=100, sd=25)(0.1)
qnorm(0.1, mean = 100, sd = 25)
qnorm(0.1, mean = 100, sd = 25, lower.tail = FALSE)
def_cdf_inv(pnorm, mean=100, sd=25)(0.1)
def_cdf_inv(pnorm, mean=100, sd=25)(0.1, mean=100, sd = 25)
qnorm(0.1, mean = 100, sd = 25)
def_cdf_inv(pnorm, mean=100, sd=25)(0.1, mean=100, sd = 25)
qnorm(0.1, mean = 100, sd = 25)
def_cdf_inv(pnorm, mean=100, sd=25)(0.2, mean=100, sd = 25)
qnorm(0.2, mean = 100, sd = 25)
x=0.3
def_cdf_inv(pnorm, mean=100, sd=25)(x, mean=100, sd = 25)
qnorm(x, mean = 100, sd = 25)
x=0.4
def_cdf_inv(pnorm, mean=100, sd=25)(x, mean=100, sd = 25)
qnorm(x, mean = 100, sd = 25)
x=0.5
def_cdf_inv(pnorm, mean=100, sd=25)(x, mean=100, sd = 25)
qnorm(x, mean = 100, sd = 25)
x=0.6
def_cdf_inv(pnorm, mean=100, sd=25)(x, mean=100, sd = 25)
qnorm(x, mean = 100, sd = 25)
x=0.7
def_cdf_inv(pnorm, mean=100, sd=25)(x, mean=100, sd = 25)
qnorm(x, mean = 100, sd = 25)
x=0.8
def_cdf_inv(pnorm, mean=100, sd=25)(x, mean=100, sd = 25)
qnorm(x, mean = 100, sd = 25)
x=0.9
def_cdf_inv(pnorm, mean=100, sd=25)(x, mean=100, sd = 25)
qnorm(x, mean = 100, sd = 25)
source("~/Documents/Rstuff/hw 8/algo 1/headers/def_cdf_inv.R")
library(testthat)
test_that("def_cdf_inv testing", {
vect=c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9)
for(x in vect){
y=def_cdf_inv(pnorm, mean=100, sd=25)(0.2, mean=100, sd = 25)
z=qnorm(0.2, mean = 100, sd = 25)
expect_equal(y,z)
}
})
source("~/Documents/Rstuff/hw 8/algo 1/headers/def_cdf_inv.R")
library(testthat)
test_that("def_cdf_inv testing", {
vect=c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9)
for(x in vect){
y=def_cdf_inv(pnorm, mean=100, sd=25)(x, mean=100, sd = 25)
z=qnorm(x, mean = 100, sd = 25)
expect_equal(y,z)
}
})
source("~/Documents/Rstuff/hw 8/algo 1/headers/def_cdf_inv.R")
inverse_sampling = function(n,cdf,cdf_inv,...){
if(missing(cdf_inv)){
writeLines("cdf_inv not supplied, numerical root finding utilized, this is inefficient\n")
cdf_inv = def_cdf_inv(cdf,...)
}
V_cdf_inv = Vectorize(cdf_inv, vectorize.args = names(formals(cdf_inv))[1])
return(V_cdf_inv(runif(n),...))
}
inverse_sampling(100,pnorm,qnorm,mean=100,sd=25)
inverse_sampling(100,pnorm,mean=100,sd=25)
source("~/Documents/Rstuff/hw 8/algo 1/main/main.R")
library(testthat)
test_that("ks_test 1", {
set.seed(3)
x=inverse_sampling(100, pnorm, qnorm, mean=100, sd = 25)
expect_gt(ks.test(x, pnorm, 100, 25)$p.value, 0.01)
})
source("~/Documents/Rstuff/hw 8/algo 1/main/main.R")
library(testthat)
test_that("ks_test 1", {
set.seed(3)
x=inverse_sampling(100, pnorm, qnorm, mean=100, sd = 25)
expect_gt(ks.test(x, pnorm, 100, 25)$p.value, 0.01)
})
test_that("ks_test 2", {
set.seed(4)
x=inverse_sampling(100, pnorm, mean=100, sd = 25)
expect_gt(ks.test(x, pnorm, 100, 25)$p.value, 0.01)
})
source("~/Documents/Rstuff/hw 8/algo 2/headers/def_env_const.R")
source("~/Documents/Rstuff/hw 8/algo 2/headers/headers.R")
source("~/Documents/Rstuff/hw 8/algo 2/headers/headers.R")
library(testthat)
test_that("def_env_const testing", {
expect_lt(def_env_const( dnorm, function(x) 1/pi/(1+xË†2)), 1.521)
})
test_that("def_env_const testing", {
expect_lt(def_env_const( dnorm, function(x) 1/pi/(1+x^2)), 1.521)
})
test_that("def_env_const test 1", {
expect_lt(def_env_const( dnorm, function(x) 1/pi/(1+x^2)), 1.521)
})
test_that("def_env_const test 2", {
expect_lt(def_env_const( dexp, function(x) 1/(1+x)^2), 1.472)
})
